# bbox ì´ë¯¸ì§€ SAM ì„¸ê·¸ë©˜í…Œì´ì…˜ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”
ê¸°ì¡´ì— ì €ì¥ëœ bbox í¬ë¡­ ì´ë¯¸ì§€ë“¤ì„ SAM(Segment Anything Model)ìœ¼ë¡œ ì„¸ê·¸ë©˜í…Œì´ì…˜í•˜ì—¬ ë°°ê²½ì„ ì œê±°í•œ ëˆ„ë¼ë”°ê¸° ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë§ˆë„¤í‚¹ í•©ì„±ì„ ìœ„í•œ íˆ¬ëª… ë°°ê²½ ì´ë¯¸ì§€ë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.

## ğŸ¯ ëª©ì 
- **ë°°ê²½ ì œê±°**: bbox í¬ë¡­ ì´ë¯¸ì§€ì˜ ë°°ê²½ì„ ì •í™•íˆ ì œê±°
- **ë§ˆë„¤í‚¹ í•©ì„± ì¤€ë¹„**: íˆ¬ëª… ë°°ê²½ ì´ë¯¸ì§€ë¡œ ë§ˆë„¤í‚¹ê³¼ í•©ì„± ê°€ëŠ¥
- **ì¼ê´„ ì²˜ë¦¬**: ê¸°ì¡´ bbox ì´ë¯¸ì§€ë“¤ì„ ìë™ìœ¼ë¡œ ì¼ê´„ ì²˜ë¦¬

## ğŸ—‚ï¸ íŒŒì¼ êµ¬ì¡°

### ì…ë ¥ êµ¬ì¡°
```
API/processed_images/
â”œâ”€â”€ top/                   # ìƒì˜ bbox ì´ë¯¸ì§€ë“¤
â”‚   â”œâ”€â”€ item_181_top.jpg
â”‚   â”œâ”€â”€ item_178_top.jpg
â”‚   â””â”€â”€ ...
â”œâ”€â”€ bottom/                # í•˜ì˜ bbox ì´ë¯¸ì§€ë“¤
â”‚   â”œâ”€â”€ item_181_bottom.jpg
â”‚   â””â”€â”€ ...
â”œâ”€â”€ outer/                 # ì•„ìš°í„° bbox ì´ë¯¸ì§€ë“¤
â”‚   â”œâ”€â”€ item_26_outer.jpg
â”‚   â””â”€â”€ ...
â””â”€â”€ dress/                 # ë“œë ˆìŠ¤ bbox ì´ë¯¸ì§€ë“¤
    â””â”€â”€ ...
```

### ì¶œë ¥ êµ¬ì¡°
```
segmented_bbox_images/
â”œâ”€â”€ top_segmented/         # ìƒì˜ ëˆ„ë¼ë”°ê¸° ê²°ê³¼
â”‚   â”œâ”€â”€ item_181_top_segmented.png
â”‚   â”œâ”€â”€ item_178_top_segmented.png
â”‚   â””â”€â”€ ...
â”œâ”€â”€ bottom_segmented/      # í•˜ì˜ ëˆ„ë¼ë”°ê¸° ê²°ê³¼
â”‚   â”œâ”€â”€ item_181_bottom_segmented.png
â”‚   â””â”€â”€ ...
â”œâ”€â”€ outer_segmented/       # ì•„ìš°í„° ëˆ„ë¼ë”°ê¸° ê²°ê³¼
â”‚   â”œâ”€â”€ item_26_outer_segmented.png
â”‚   â””â”€â”€ ...
â”œâ”€â”€ dress_segmented/       # ë“œë ˆìŠ¤ ëˆ„ë¼ë”°ê¸° ê²°ê³¼
â”‚   â””â”€â”€ ...
â”œâ”€â”€ segmentation_report.json    # ì²˜ë¦¬ ê²°ê³¼ ìš”ì•½
â””â”€â”€ detailed_results.json       # ìƒì„¸ ì²˜ë¦¬ ê²°ê³¼
```

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. í™˜ê²½ ì„¤ì •
```bash
# segment-anything ì„¤ì¹˜
pip install git+https://github.com/facebookresearch/segment-anything.git

# ê¸°íƒ€ í•„ìš”í•œ íŒ¨í‚¤ì§€
pip install torch torchvision opencv-python pillow matplotlib tqdm
```

### 2. ì‹¤í–‰
```bash
# ë°©ë²• 1: ì§ì ‘ ì‹¤í–‰
cd c
python 13_bbox_sam_segmentation.py

# ë°©ë²• 2: ë˜í¼ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©
cd c
python run_bbox_sam.py
```

## ğŸ”§ ì£¼ìš” ê¸°ëŠ¥

### 1. ìë™ bbox ì„¸ê·¸ë©˜í…Œì´ì…˜
```python
# bbox ì´ë¯¸ì§€ ì „ì²´ë¥¼ ê°ì²´ë¡œ ì¸ì‹
bbox = [0, 0, width, height]  # ì „ì²´ ì´ë¯¸ì§€ ì˜ì—­

# ì¤‘ì•™ì ì„ í¬ê·¸ë¼ìš´ë“œ í¬ì¸íŠ¸ë¡œ ì‚¬ìš©
center_point = [width//2, height//2]

# SAMìœ¼ë¡œ ì •ë°€ ì„¸ê·¸ë©˜í…Œì´ì…˜
mask, score = sam.predict(box=bbox, point_coords=center_point)
```

### 2. íˆ¬ëª… ë°°ê²½ ìƒì„±
- **PNG í˜•ì‹**: ì•ŒíŒŒ ì±„ë„ ì§€ì›
- **RGBA**: ì™„ì „í•œ íˆ¬ëª…ë„
- **ê³ í’ˆì§ˆ**: ì›ë³¸ í•´ìƒë„ ìœ ì§€

### 3. ì¹´í…Œê³ ë¦¬ë³„ ì¼ê´„ ì²˜ë¦¬
- **top**: ìƒì˜ ì´ë¯¸ì§€ë“¤
- **bottom**: í•˜ì˜ ì´ë¯¸ì§€ë“¤
- **outer**: ì•„ìš°í„° ì´ë¯¸ì§€ë“¤
- **dress**: ë“œë ˆìŠ¤ ì´ë¯¸ì§€ë“¤

## ğŸ“Š ì²˜ë¦¬ ê²°ê³¼

### 1. íŒŒì¼ëª… ê·œì¹™
```
{ì›ë³¸íŒŒì¼ëª…}_segmented.png
ì˜ˆ: item_181_top.jpg -> item_181_top_segmented.png
```

### 2. ìš”ì•½ ë¦¬í¬íŠ¸ (segmentation_report.json)
```json
{
  "summary": {
    "total_files": 150,
    "successful_files": 145,
    "failed_files": 5,
    "success_rate": 96.7
  },
  "category_stats": {
    "top": {
      "total": 50,
      "success": 48,
      "failed": 2,
      "success_rate": 96.0,
      "average_mask_score": 0.892
    }
  }
}
```

### 3. ìƒì„¸ ê²°ê³¼ (detailed_results.json)
```json
[
  {
    "input_path": "API/processed_images/top/item_181_top.jpg",
    "output_path": "segmented_bbox_images/top_segmented/item_181_top_segmented.png",
    "category": "top",
    "mask_score": 0.95,
    "success": true
  }
]
```

## âš™ï¸ ì„¤ì • ì˜µì…˜

### 1. SAM ëª¨ë¸ íƒ€ì…
```python
model_type = "vit_h"  # vit_h (ì •í™•), vit_l (ê· í˜•), vit_b (ë¹ ë¦„)
```

### 2. ì¤‘ì•™ì  ì‚¬ìš© ì—¬ë¶€
```python
use_center_point = True  # ì¤‘ì•™ì ì„ í¬ê·¸ë¼ìš´ë“œë¡œ ì‚¬ìš©
```

### 3. íˆ¬ëª…ë„ ì„¤ì •
```python
alpha = 1.0  # íˆ¬ëª…ë„ (0.0 ~ 1.0)
```

## ğŸ¨ ë§ˆë„¤í‚¹ í•©ì„± í™œìš©

### 1. í•©ì„± ì¤€ë¹„
- **íˆ¬ëª… ë°°ê²½**: ë§ˆë„¤í‚¹ ì´ë¯¸ì§€ì™€ ìì—°ìŠ¤ëŸ¬ìš´ í•©ì„±
- **ê³ í’ˆì§ˆ**: ì›ë³¸ í•´ìƒë„ ìœ ì§€
- **ì¼ê´€ì„±**: ëª¨ë“  ì˜ë¥˜ ì•„ì´í…œ ë™ì¼í•œ ì²˜ë¦¬

### 2. í•©ì„± ì˜ˆì‹œ
```python
# ë§ˆë„¤í‚¹ ì´ë¯¸ì§€ ë¡œë“œ
mannequin = cv2.imread("mannequin.png", cv2.IMREAD_UNCHANGED)

# ì„¸ê·¸ë©˜í…Œì´ì…˜ëœ ì˜ë¥˜ ë¡œë“œ
clothing = cv2.imread("item_181_top_segmented.png", cv2.IMREAD_UNCHANGED)

# ì•ŒíŒŒ ë¸”ë Œë”©ìœ¼ë¡œ í•©ì„±
result = blend_with_alpha(mannequin, clothing)
```

### 3. í™œìš© ë°©ì•ˆ
- **ê°€ìƒ í”¼íŒ…ë£¸**: ì‚¬ìš©ì ì•„ë°”íƒ€ì— ì˜ë¥˜ í•©ì„±
- **ìƒí’ˆ ì´ë¯¸ì§€**: ë§ˆë„¤í‚¹ ëª¨ë¸ì— ì˜ë¥˜ ì°©ìš©
- **ìŠ¤íƒ€ì¼ ì‹œë®¬ë ˆì´ì…˜**: ë‹¤ì–‘í•œ ì˜ë¥˜ ì¡°í•© ì‹œê°í™”

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### 1. GPU ì‚¬ìš©
```python
device = "cuda" if torch.cuda.is_available() else "cpu"
```

### 2. ë°°ì¹˜ ì²˜ë¦¬
- ì´ë¯¸ì§€ë³„ ìˆœì°¨ ì²˜ë¦¬
- ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ê´€ë¦¬
- ì§„í–‰ë¥  í‘œì‹œ

### 3. í’ˆì§ˆ ì„¤ì •
- **vit_h**: ê°€ì¥ ì •í™•í•œ ì„¸ê·¸ë©˜í…Œì´ì…˜
- **ì¤‘ì•™ì  ì‚¬ìš©**: ë” ì •í™•í•œ ê°ì²´ ì¸ì‹
- **ë©€í‹°ë§ˆìŠ¤í¬**: ìµœì  ë§ˆìŠ¤í¬ ìë™ ì„ íƒ

## ğŸ” ë¬¸ì œ í•´ê²°

### 1. segment-anything ì„¤ì¹˜ ì˜¤ë¥˜
```bash
# PyTorch ë²„ì „ í™•ì¸
pip install torch torchvision

# segment-anything ì¬ì„¤ì¹˜
pip uninstall segment-anything
pip install git+https://github.com/facebookresearch/segment-anything.git
```

### 2. CUDA ë©”ëª¨ë¦¬ ë¶€ì¡±
```python
# CPU ì‚¬ìš©ìœ¼ë¡œ ë³€ê²½
device = "cpu"

# ë˜ëŠ” ì´ë¯¸ì§€ í¬ê¸° ì¤„ì´ê¸°
image = cv2.resize(image, (512, 512))
```

### 3. ì„¸ê·¸ë©˜í…Œì´ì…˜ í’ˆì§ˆ ë¬¸ì œ
```python
# ì¤‘ì•™ì  ì‚¬ìš© í™œì„±í™”
use_center_point = True

# ë” í° ëª¨ë¸ ì‚¬ìš©
model_type = "vit_h"
```

## ğŸ“ ì£¼ì˜ì‚¬í•­

1. **íŒŒì¼ í˜•ì‹**: ì…ë ¥ì€ JPG, ì¶œë ¥ì€ PNG (íˆ¬ëª…ë„ ì§€ì›)
2. **ë©”ëª¨ë¦¬ ì‚¬ìš©**: í° ì´ë¯¸ì§€ ì²˜ë¦¬ ì‹œ GPU ë©”ëª¨ë¦¬ ê³ ë ¤
3. **ì²˜ë¦¬ ì‹œê°„**: ì´ë¯¸ì§€ ìˆ˜ì™€ í¬ê¸°ì— ë”°ë¼ ì‹œê°„ ì†Œìš”
4. **í’ˆì§ˆ**: ë³µì¡í•œ ë°°ê²½ì¼ìˆ˜ë¡ ì„¸ê·¸ë©˜í…Œì´ì…˜ í’ˆì§ˆ í–¥ìƒ

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. **ë§ˆë„¤í‚¹ í•©ì„±**: íˆ¬ëª… ë°°ê²½ ì´ë¯¸ì§€ë¥¼ ë§ˆë„¤í‚¹ê³¼ í•©ì„±
2. **í¬ì¦ˆ ë³€í™˜**: ë‹¤ì–‘í•œ í¬ì¦ˆì˜ ë§ˆë„¤í‚¹ì— ì ìš©
3. **ìŠ¤íƒ€ì¼ ì¡°í•©**: ì—¬ëŸ¬ ì˜ë¥˜ ì•„ì´í…œ ì¡°í•©
4. **ì‹¤ì‹œê°„ í•©ì„±**: ì›¹/ì•±ì—ì„œ ì‹¤ì‹œê°„ í•©ì„± ê¸°ëŠ¥
